<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake</title>
</head>

<body>
    <canvas id="myCanvas" width="300" height="300" style="border:2px solid black;">
        Your browser does not support the HTML5 canvas tag.</canvas>

    <script>
        var c = document.getElementById("myCanvas");
        var cWidth = c.getAttribute("width")
        var cHeight = c.getAttribute("height")
        var cols = cHeight / 20
        var lines = cWidth / 20
        var snake = [[1, 0], [1, 0], [2, 0]]
        var lastKey = "ArrowRight"

        var ctx = c.getContext("2d");

        setInterval(drawGame, 500)

        document.addEventListener("keydown", (event) => {
            lastKey = event.key
        })

        function drawGame() {
            if (snake[0][0] >= cWidth || snake[0][0] < 0) {
                console.log("game over")
            } else if (snake[0][1] >= cHeight || snake[0][1] < 0) {
                console.log("game over")
            } else {
                ctx.beginPath()
                ctx.clearRect(0, 0, cWidth, cHeight)    
                snake.forEach(piece => {
                    ctx.fillRect(piece[0] * 10, piece[1] * 10, 20, 20)
                    if (lastKey == "ArrowUp") {
                        moveSnake(0, -1)
                    } else if (lastKey == "ArrowLeft") {
                        moveSnake(-1, 0)
                    } else if (lastKey == "ArrowDown") {
                        moveSnake(0, 1)
                    } else if (lastKey == "ArrowRight") {
                        moveSnake(1, 0)
                    }
                });
            }
        }

        function moveSnake(px, py) {
            let newPieces = []
            let lastIndex = snake.length - 1
            let newPlaceHead = [snake[lastIndex][0] + px, snake[lastIndex][1] + py]

            for (let index = 0; index < lastIndex ; index++) {
                newPieces.push([snake[index + 1][0], snake[index + 1][1]])
            }

            newPieces.push(newPlaceHead)
            snake = newPieces
            console.log(snake)
        }

    </script>
</body>

</html>